<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–®–ø–∏–æ–Ω –ø–æ –ö–∞—Ä—Ç–µ Clash Royale</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* –°—Ç–∏–ª—å –¥–ª—è —Å—Ç—Ä–µ–ª–∫–∏ —Ä—É–ª–µ—Ç–∫–∏ */
        #spinner-arrow {
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-bottom: 60px solid #dc2626; /* –ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç */
            position: absolute;
            top: 0;
            left: 50%;
            /* –£–¥–∞–ª–µ–Ω margin-left –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ transform */
            transform-origin: 50% 100%; 
        }
        
        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä—É–ª–µ—Ç–∫–∏ */
        #spinner-area {
            position: relative;
            width: 100%;
            height: 128px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –±–æ–ª—å—à–æ–≥–æ, —Å–∫—Ä—ã—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ —Ä–æ–ª–∏ */
        .role-text-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            height: 100vh;
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen p-4">

    <div id="game-container" class="max-w-md mx-auto">
        <h1 class="text-3xl font-bold text-center mb-6 text-red-500">–®–ø–∏–æ–Ω –ø–æ –ö–∞—Ä—Ç–µ CR</h1>
        
        <div id="mode-selection-screen" class="bg-gray-800 p-6 rounded-lg shadow-xl">
            <h2 class="text-2xl font-bold mb-4 text-yellow-400">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º</h2>
            <p class="mb-6 text-gray-400">–°–ø–µ—Ä–≤–∞ –≤—ã–±–µ—Ä–∏—Ç–µ, —Ö–æ—Ç–∏—Ç–µ –ª–∏ –≤—ã –∏–≥—Ä–∞—Ç—å —Å —Å—é—Ä–ø—Ä–∏–∑–∞–º–∏.</p>
            
            <button onclick="selectGameMode('CLASSIC')" class="w-full py-4 mb-4 bg-red-600 hover:bg-red-700 rounded-md font-bold transition duration-150">
                <span class="text-xl">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º</span><br>
                <span class="text-sm">–í—Å–µ–≥–¥–∞ 1 —à–ø–∏–æ–Ω.</span>
            </button>
            
            <button onclick="selectGameMode('FUNNY')" class="w-full py-4 bg-green-600 hover:bg-green-700 rounded-md font-bold transition duration-150">
                <span class="text-xl">–†–µ–∂–∏–º —Å –ø—Ä–∏–∫–æ–ª–∞–º–∏</span><br>
                <span class="text-sm">10% —à–∞–Ω—Å –Ω–∞ –í—Å–µ—Ö –®–ø–∏–æ–Ω–æ–≤ / –í—Å–µ—Ö –ú–∏—Ä–Ω—ã—Ö.</span>
            </button>
        </div>

        <div id="setup-screen" class="hidden bg-gray-800 p-6 rounded-lg shadow-xl">
            <h2 class="text-xl font-semibold mb-4">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞</h2>
            <label for="player-count" class="block text-sm font-medium mb-2">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä–æ–∫–æ–≤ (–º–∏–Ω. 3):</label>
            <input type="number" id="player-count" min="3" value="4" class="w-full p-3 mb-4 rounded-md bg-gray-700 text-white border-none focus:ring-red-500 focus:border-red-500">
            <button onclick="startGameSetup()" class="w-full py-3 bg-red-600 hover:bg-red-700 rounded-md font-bold transition duration-150">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        </div>

        <div id="spinner-screen" class="hidden bg-gray-800 p-6 rounded-lg shadow-xl text-center">
            <h2 class="text-xl font-semibold mb-4">üéØ –í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞</h2>
            
            <div id="spinner-area" class="relative w-full h-32 mx-auto my-6 border-4 border-gray-700 rounded-lg flex items-center justify-center">
                <div id="spinner-arrow" style="transform: translateX(-50%) rotate(0deg);"></div>
            </div>
            
            <p id="spinner-names" class="text-lg font-bold text-center p-2 mb-4 text-gray-400">–ò–≥—Ä–æ–∫–∏: 1 / 2 / 3 / 4</p>
            
            <p class="text-sm mb-4">–ù–∞ –∫–æ–≥–æ —É–∫–∞–∂–µ—Ç —Å—Ç—Ä–µ–ª–∫–∞ –ø–æ—Å–ª–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ ‚Äî —Ç–æ—Ç –±—É–¥–µ—Ç –ò–≥—Ä–æ–∫ ‚Ññ1 –∏ –Ω–∞—á–Ω–µ—Ç —Ä–∞–∑–¥–∞—á—É.</p>
            <button onclick="spinWheel()" id="spin-button" class="w-full py-3 bg-green-600 hover:bg-green-700 rounded-md font-bold transition duration-150">–ö–†–£–¢–ò–¢–¨ –°–¢–†–ï–õ–ö–£</button>
        </div>

        <div id="role-distribution-screen" class="hidden bg-gray-800 p-6 rounded-lg shadow-xl">
            <h2 id="current-player-heading" class="text-2xl font-bold text-center mb-6 text-yellow-400"></h2>
            
            <div id="role-cards-container" class="grid grid-cols-3 gap-3 mb-6">
                </div>

            <button onclick="showRole()" id="show-role-button" class="w-full py-4 bg-blue-600 hover:bg-blue-700 rounded-md font-bold transition duration-150">
                –û—Ç–∫—Ä—ã—Ç—å –º–æ—é –∫–∞—Ä—Ç—É
            </button>
        </div>

        <div id="role-view-screen" class="hidden fixed inset-0 bg-gray-900 z-50 p-4">
            <div class="role-text-container">
                <p id="role-title" class="text-2xl font-light mb-4 text-gray-400"></p>
                <div id="role-image-container" class="mb-6">
                    </div>
                <p id="role-content" class="text-6xl font-extrabold mb-10 text-red-500 animate-pulse"></p>
                
                <button onclick="hideRole()" class="mt-10 py-3 px-8 bg-green-600 hover:bg-green-700 rounded-full font-bold transition duration-150 text-xl shadow-lg">
                    –Ø –∑–∞–ø–æ–º–Ω–∏–ª(–∞)! –ü–µ—Ä–µ–¥–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–º—É
                </button>
            </div>
        </div>

        <div id="game-start-screen" class="hidden bg-gray-800 p-6 rounded-lg shadow-xl text-center">
            <h2 class="text-4xl font-extrabold text-green-400 mt-10 mb-8">‚öîÔ∏è –ò–ì–†–ê –ù–ê–ß–ê–õ–ê–°–¨!</h2>
            <p class="text-lg mb-8">–û–±—Å—É–∂–¥–∞–π—Ç–µ –∫–∞—Ä—Ç—É, –Ω–µ –Ω–∞–∑—ã–≤–∞—è –µ–µ. –ü–æ—Ä—è–¥–æ–∫ –∏–≥—Ä—ã: –ø–æ –Ω–æ–º–µ—Ä–∞–º, –Ω–∞—á–∏–Ω–∞—è —Å –ò–≥—Ä–æ–∫–∞ ‚Ññ1.</p>
            <button onclick="showResults()" class="py-2 px-6 bg-red-800 hover:bg-red-900 rounded-md text-sm font-semibold">
                –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–°–µ–∫—Ä–µ—Ç)
            </button>
        </div>

        <div id="results-screen" class="hidden bg-gray-800 p-6 rounded-lg shadow-xl text-center">
            <h2 class="text-3xl font-extrabold mb-4 text-red-500">üéâ –†–ï–ó–£–õ–¨–¢–ê–¢–´ –†–ê–£–ù–î–ê</h2>
            <p class="text-lg mb-2">–°–µ–∫—Ä–µ—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞:</p>
            <p id="final-card" class="text-4xl font-bold mb-4 text-green-400"></p>
            <p class="text-lg mb-2" id="final-spy-title">–®–ø–∏–æ–Ω:</p>
            <p id="final-spy" class="text-4xl font-bold mb-8 text-yellow-400"></p>
            <button onclick="window.location.reload()" class="w-full py-3 bg-red-600 hover:bg-red-700 rounded-md font-bold transition duration-150">
                –ù–æ–≤–∞—è –∏–≥—Ä–∞ (–ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å)
            </button>
        </div>
    </div>

    <script>
        // --- 1. –°–ü–ò–°–û–ö –ö–ê–†–¢ –° –¢–û–ß–ù–´–ú–ò –°–õ–ê–ì–ê–ú–ò –î–õ–Ø –ö–ê–†–¢–ò–ù–û–ö ---
        const CARDS_DATA = [
            { ru: "–¢—Ä–∏ –º—É—à–∫–µ—Ç–µ—Ä–∞", slug: "3M" },
            { ru: "–ì–æ–ª–µ–º", slug: "Golem" },
            { ru: "–ö–æ—Ä–æ–ª–µ–≤—Å–∫–∏–µ —Ä–µ–∫—Ä—É—Ç—ã", slug: "RoyalRecruits" },
            { ru: "–ü.–ï.–ö.–ö.–ê.", slug: "PEKKA" },
            { ru: "–≠–ª–µ–∫—Ç—Ä–æ–≥–∏–≥–∞–Ω—Ç", slug: "ElectroGiant" },
            { ru: "–ú–µ–≥–∞—Ä—ã—Ü–∞—Ä—å", slug: "MegaKnight" },
            { ru: "–ê–¥—Å–∫–∞—è –≥–æ–Ω—á–∞—è", slug: "Lava" },
            { ru: "–ö–æ—Ä–æ–ª–µ–≤—Å–∫–∏–π –≥–∏–≥–∞–Ω—Ç", slug: "RG" },
            { ru: "–≠–ª–∏—Ç–Ω—ã–µ –≤–∞—Ä–≤–∞—Ä—ã", slug: "eBarbs" },
            { ru: "–†–∞–∫–µ—Ç–∞", slug: "Rocket" },
            { ru: "–•–∏–∂–∏–Ω–∞ –≤–∞—Ä–≤–∞—Ä–æ–≤", slug: "BarbHut" },
            { ru: "–°–±–æ—Ä—â–∏–∫ —ç–ª–∏–∫—Å–∏—Ä–∞", slug: "Pump" },
            { ru: "–ì–∏–≥–∞–Ω—Ç—Å–∫–∏–π —Å–∫–µ–ª–µ—Ç", slug: "GiantSkelly" },
            { ru: "–ú–æ–ª–Ω–∏—è", slug: "Lightning" },
            { ru: "–ì–æ–±–ª–∏–Ω-–≥–∏–≥–∞–Ω—Ç", slug: "GobGiant" },
            { ru: "–ê—Ä–±–∞–ª–µ—Ç", slug: "XBow" },
            { ru: "–°–ø–∞—Ä–∫–∏", slug: "Sparky" },
            { ru: "–ò–º–ø–µ—Ä–∞—Ç—Ä–∏—Ü–∞ –¥—É—Ö–æ–≤", slug: "SpiritEmpress" },
            { ru: "–ì–ª–∞–≤–Ω–∞—è –±–∞–Ω–¥–∏—Ç–∫–∞", slug: "BossBandit" },
            { ru: "–í–∞—Ä–≤–∞—Ä—ã", slug: "Barbs" },
            { ru: "–û—Ä–¥–∞ –º–∏–Ω—å–æ–Ω–æ–≤", slug: "Horde" },
            { ru: "–†–∞–∑–±–æ–π–Ω–∏–∫–∏", slug: "Rascals" },
            { ru: "–ì–∏–≥–∞–Ω—Ç", slug: "Giant" },
            { ru: "–ê–¥—Å–∫–∞—è –±–∞—à–Ω—è", slug: "Inferno" },
            { ru: "–ö–æ–ª–¥—É–Ω", slug: "Wiz" },
            { ru: "–ö–æ—Ä–æ–ª–µ–≤—Å–∫–∏–µ –∫–∞–±–∞–Ω—ã", slug: "RoyalHogs" },
            { ru: "–í–µ–¥—å–º–∞", slug: "Witch" },
            { ru: "–®–∞—Ä", slug: "Balloon" },
            { ru: "–ü—Ä–∏–Ω—Ü", slug: "Prince" },
            { ru: "–≠–ª–µ–∫—Ç—Ä–æ–¥—Ä–∞–∫–æ–Ω", slug: "eDragon" },
            { ru: "–í—ã—à–∏–±–∞–ª–∞", slug: "Bowler" },
            { ru: "–ü–∞–ª–∞—á", slug: "Exe" },
            { ru: "–ü–æ–≤–æ–∑–∫–∞ —Å –ø—É—à–∫–æ–π", slug: "CannonCart" },
            { ru: "–í—Å–∞–¥–Ω–∏—Ü–∞ –Ω–∞ –±–∞—Ä–∞–Ω–µ", slug: "RamRider" },
            { ru: "–ö–ª–∞–¥–±–∏—â–µ", slug: "Graveyard" },
            { ru: "–ì–æ–±–ª–∏–Ω—Å–∫–∞—è –º–∞—à–∏–Ω–∞", slug: "GoblinMachine" },
            { ru: "–ö–æ—Ä–æ–ª–µ–≤–∞ –ª—É—á–Ω–∏—Ü", slug: "ArcherQueen" },
            { ru: "–ì–æ–±–ª–∏–Ω—à—Ç–µ–π–Ω", slug: "Goblinstein" },
            { ru: "–ú–æ–Ω–∞—Ö", slug: "Monk" },
            { ru: "–ö–æ—Å—Ç—è–Ω—ã–µ –¥—Ä–∞–∫–æ–Ω—ã", slug: "SkeletonDragons" },
            { ru: "–ú–æ—Ä—Ç–∏—Ä–∞", slug: "Mortar" },
            { ru: "–¢–µ—Å–ª–∞", slug: "Tesla" },
            { ru: "–û–≥–Ω–µ–Ω–Ω—ã–π —à–∞—Ä", slug: "Fireball" },
            { ru: "–ú–∏–Ω–∏-–ü.–ï.–ö.–ö.–ê", slug: "MP" },
            { ru: "–ú—É—à–∫–µ—Ç–µ—Ä", slug: "Musk" },
            { ru: "–ö–ª–µ—Ç–∫–∞ —Å –≥–æ–±–ª–∏–Ω–æ–º", slug: "GoblinCage" },
            { ru: "–•–∏–∂–∏–Ω–∞ –≥–æ–±–ª–∏–Ω–æ–≤", slug: "GobHut" },
            { ru: "–í–∞–ª—å–∫–∏—Ä–∏—è", slug: "Valk" },
            { ru: "–ë–æ–µ–≤–æ–π —Ç–∞—Ä–∞–Ω", slug: "Ram" },
            { ru: "–ë–∞—à–Ω—è-–±–æ–º–±–µ–∂–∫–∞", slug: "BombTower" },
            { ru: "–õ–µ—Ç—É—á–∫–∞", slug: "FlyingMachine" },
            { ru: "–í—Å–∞–¥–Ω–∏–∫ –Ω–∞ –∫–∞–±–∞–Ω–µ", slug: "Hog" },
            { ru: "–¶–µ–ª–∏—Ç–µ–ª—å–Ω–∏—Ü–∞-–≤–æ–∏–Ω", slug: "BattleHealer" },
            { ru: "–ü–µ—á—å", slug: "Furnace" },
            { ru: "–ú–∏–Ω–∏-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã", slug: "Zappies" },
            { ru: "–ì–æ–±–ª–∏–Ω-–ø–æ–¥—Ä—ã–≤–Ω–∏–∫", slug: "GoblinDemolisher" },
            { ru: "–î—Ä–∞–∫–æ–Ω—á–∏–∫", slug: "BabyD" },
            { ru: "–¢–µ–º–Ω—ã–π –ø—Ä–∏–Ω—Ü", slug: "DarkPrince" },
            { ru: "–ó–∞–º–æ—Ä–æ–∑–∫–∞", slug: "Freeze" },
            { ru: "–Ø–¥", slug: "Poison" },
            { ru: "–†—É–Ω–∏—á–µ—Å–∫–∞—è –≥–∏–≥–∞–Ω—Ç—à–∞", slug: "RuneGiant" },
            { ru: "–û—Ö–æ—Ç–Ω–∏–∫", slug: "Hunter" },
            { ru: "–ì–æ–±–ª–∏–Ω—Å–∫–∏–π –±—É—Ä", slug: "GoblinDrill" },
            { ru: "–ì—Ä–æ–º–æ–≤–µ—Ä–∂–µ—Ü", slug: "eWiz" },
            { ru: "–ü–ª–∞–º–µ–Ω–Ω—ã–π –¥—Ä–∞–∫–æ–Ω", slug: "InfernoD" },
            { ru: "–§–µ–Ω–∏–∫—Å", slug: "Phoenix" },
            { ru: "–ú–∞–≥–∏—á–µ—Å–∫–∏–π –ª—É—á–Ω–∏–∫", slug: "MagicArcher" },
            { ru: "–î—Ä–æ–≤–æ—Å–µ–∫", slug: "Lumber" },
            { ru: "–ù–æ—á–Ω–∞—è –≤–µ–¥—å–º–∞", slug: "NightWitch" },
            { ru: "–í–µ–¥—å–º–∏–Ω–∞ –±–∞–±—É—à–∫–∞", slug: "MotherWitch" },
            { ru: "–ó–æ–ª–æ—Ç–æ–π —Ä—ã—Ü–∞—Ä—å", slug: "GoldenKnight" },
            { ru: "–ö–æ—Ä–æ–ª—å —Å–∫–µ–ª–µ—Ç–æ–≤", slug: "SkeletonKing" },
            { ru: "–®—É—Å—Ç—Ä—ã–π —à–∞—Ö—Ç–µ—Ä", slug: "MightyMiner" },
            { ru: "–õ—É—á–Ω–∏—Ü—ã", slug: "Archers" },
            { ru: "–°—Ç—Ä–µ–ª—ã", slug: "Arrows" },
            { ru: "–†—ã—Ü–∞—Ä—å", slug: "Knight" },
            { ru: "–ú–∏–Ω—å–æ–Ω—ã", slug: "Minions" },
            { ru: "–ü—É—à–∫–∞", slug: "Cannon" },
            { ru: "–ë–∞–Ω–¥–∞ –≥–æ–±–ª–∏–Ω–æ–≤", slug: "GobGang" },
            { ru: "–ë–æ—á–∫–∞ —Å–æ —Å–∫–µ–ª–µ—Ç–∞–º–∏", slug: "SkellyBarrel" },
            { ru: "–û–≥–Ω–µ–Ω–Ω–∞—è –ª—É—á–Ω–∏—Ü–∞", slug: "Firecracker" },
            { ru: "–ö–æ—Ä–æ–ª–µ–≤—Å–∫–∞—è –ø–æ—á—Ç–∞", slug: "RoyalDelivery" },
            { ru: "–ù–∞–¥–≥—Ä–æ–±–∏–µ", slug: "Tombstone" },
            { ru: "–ú–µ–≥–∞–º–∏–Ω—å–æ–Ω", slug: "MM" },
            { ru: "–ì–æ–±–ª–∏–Ω —Å –¥—Ä–æ—Ç–∏–∫–∞–º–∏", slug: "DartGob" },
            { ru: "–ó–µ–º–ª–µ—Ç—Ä—è—Å–µ–Ω–∏–µ", slug: "Earthquake" },
            { ru: "–≠–ª–∏–∫—Å–∏—Ä–Ω—ã–π –≥–æ–ª–µ–º", slug: "ElixirGolem" },
            { ru: "–ì–æ–±–ª–∏–Ω—Å–∫–∞—è –±–æ—á–∫–∞", slug: "Barrel" },
            { ru: "–°—Ç—Ä–∞–∂–∏", slug: "Guards" },
            { ru: "–ê—Ä–º–∏—è —Å–∫–µ–ª–µ—Ç–æ–≤", slug: "Skarmy" },
            { ru: "Vines", slug: "Vines" },
            { ru: "–ö–ª–æ–Ω", slug: "Clone" },
            { ru: "–¢–æ—Ä–Ω–∞–¥–æ", slug: "Tornado" },
            { ru: "–ë–µ–∑–¥–Ω–∞", slug: "Void" },
            { ru: "–®–∞—Ö—Ç–µ—Ä", slug: "Miner" },
            { ru: "–ü—Ä–∏–Ω—Ü–µ—Å—Å–∞", slug: "Princess" },
            { ru: "–õ–µ–¥—è–Ω–æ–π –∫–æ–ª–¥—É–Ω", slug: "IceWiz" },
            { ru: "–ö–æ—Ä–æ–ª–µ–≤—Å–∫–∏–π –ø—Ä–∏–∑—Ä–∞–∫", slug: "Ghost" },
            { ru: "–ë–∞–Ω–¥–∏—Ç–∫–∞", slug: "Bandit" },
            { ru: "–†—ã–±–∞–∫", slug: "Fisherman" },
            { ru: "–ú–∞–ª–µ–Ω—å–∫–∏–π –ø—Ä–∏–Ω—Ü", slug: "LittlePrince" },
            { ru: "–ì–æ–±–ª–∏–Ω—ã", slug: "Gobs" },
            { ru: "–ì–æ–±–ª–∏–Ω—ã-–∫–æ–ø–µ–π—â–∏–∫–∏", slug: "SpearGobs" },
            { ru: "–ü–æ–¥—Ä—ã–≤–Ω–∏–∫", slug: "Bomber" },
            { ru: "–õ–µ—Ç—É—á–∏–µ –º—ã—à–∏", slug: "Bats" },
            { ru: "–†–∞–∑—Ä—è–¥", slug: "Zap" },
            { ru: "–ì–∏–≥–∞–Ω—Ç—Å–∫–∏–π —Å–Ω–µ–∂–æ–∫", slug: "Snowball" },
            { ru: "–ë–µ—Ä—Å–µ—Ä–∫—à–∞", slug: "Berserker" },
            { ru: "–õ–µ–¥—è–Ω–æ–π –≥–æ–ª–µ–º", slug: "IceGolem" },
            { ru: "–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∫—É—Å—Ç", slug: "SuspiciousBush" },
            { ru: "–í–∞—Ä–≤–∞—Ä—Å–∫–∞—è –±–æ—á–∫–∞", slug: "BarbBarrel" },
            { ru: "–°—Ç–µ–Ω–æ–±–æ–∏", slug: "WallBreakers" },
            { ru: "–ü—Ä–æ–∫–ª—è—Ç–∏–µ –≥–æ–±–ª–∏–Ω–æ–≤", slug: "GoblinCurse" },
            { ru: "–Ø—Ä–æ—Å—Ç—å", slug: "Rage" },
            { ru: "–ë—Ä–µ–≤–Ω–æ", slug: "Log" },
            { ru: "–°–∫–µ–ª–µ—Ç—ã", slug: "Skellies" },
            { ru: "–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π –¥—É—Ö", slug: "ElectroSpirit" },
            { ru: "–û–≥–Ω–µ–Ω–Ω—ã–π –¥—É—Ö", slug: "FireSpirit" },
            { ru: "–õ–µ–¥—è–Ω–æ–π –¥—É—Ö", slug: "IceSpirit" },
            { ru: "–î—É—Ö –∏—Å—Ü–µ–ª–µ–Ω–∏—è", slug: "HealSpirit" }
        ];

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã
        let playerCount = 0;
        let spyIndex = -2; 
        let secretCardData = {}; 
        let currentPlayerIndex = 1;
        let roles = {}; 
        let gameModeSetting = 'FUNNY'; // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º, –Ω–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ selectGameMode

        // --- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Å—ã–ª–∫–∏ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ---
        function getCardImage(slug) {
            const baseUrl = "https://www.deckshop.pro/img/c/";
            const fallbackUrl = "https://www.deckshop.pro/img/misc/card_back.png"; 

            if (!slug) return fallbackUrl;
            
            return `${baseUrl}${slug}.png`;
        }

        // --- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞–º–∏ ---
        function showScreen(screenId) {
            const screens = ['mode-selection-screen', 'setup-screen', 'spinner-screen', 'role-distribution-screen', 'game-start-screen', 'results-screen'];
            screens.forEach(id => {
                document.getElementById(id).classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
        }

        // --- –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –í–´–ë–û–† –†–ï–ñ–ò–ú–ê ---
        function selectGameMode(mode) {
            gameModeSetting = mode;
            showScreen('setup-screen');
        }
        
        // --- 1. –ù–ê–°–¢–†–û–ô–ö–ê –ò–ì–†–´ ---
        function startGameSetup() {
            const count = parseInt(document.getElementById('player-count').value);
            if (count < 3 || isNaN(count)) {
                alert("–¢—Ä–µ–±—É–µ—Ç—Å—è –º–∏–Ω–∏–º—É–º 3 –∏–≥—Ä–æ–∫–∞!");
                return;
            }
            
            playerCount = count;
            setupGameLogic();

            const namesContainer = document.getElementById('spinner-names');
            namesContainer.textContent = '–ò–≥—Ä–æ–∫–∏: ' + Array.from({ length: playerCount }, (_, i) => `${i + 1}`).join(' / ');
            
            showScreen('spinner-screen');
        }

        // --- –õ–û–ì–ò–ö–ê –ñ–ï–†–ï–ë–¨–ï–í–ö–ò (–û–ë–ù–û–í–õ–ï–ù–û –î–õ–Ø –†–ï–ñ–ò–ú–û–í) ---
        function setupGameLogic() {
            secretCardData = CARDS_DATA[Math.floor(Math.random() * CARDS_DATA.length)];
            
            let gameMode = "NORMAL";
            
            if (gameModeSetting === 'FUNNY') {
                // 10% —à–∞–Ω—Å –Ω–∞ —Å–ø–µ—Ü. —Ä–∞—É–Ω–¥, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω —Ä–µ–∂–∏–º FUNNY
                const modeRoll = Math.random();
                
                if (modeRoll < 0.05) { // 5% —à–∞–Ω—Å
                    gameMode = "ALL_SPIES";
                } else if (modeRoll < 0.10) { // 5% —à–∞–Ω—Å
                    gameMode = "ALL_LOCALS";
                }
            }

            roles = {};
            
            if (gameMode === "ALL_SPIES") {
                spyIndex = 0; // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å: –í—Å–µ —à–ø–∏–æ–Ω—ã
                for (let i = 1; i <= playerCount; i++) {
                    roles[i] = "–®–ü–ò–û–ù";
                }
            } else if (gameMode === "ALL_LOCALS") {
                spyIndex = -1; // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å: –ù–µ—Ç —à–ø–∏–æ–Ω–∞
                for (let i = 1; i <= playerCount; i++) {
                    roles[i] = secretCardData;
                }
            } else { // NORMAL mode (–≤–∫–ª—é—á–∞—è CLASSIC —Ä–µ–∂–∏–º)
                spyIndex = Math.floor(Math.random() * playerCount) + 1;
                for (let i = 1; i <= playerCount; i++) {
                    roles[i] = (i === spyIndex) ? "–®–ü–ò–û–ù" : secretCardData;
                }
            }
        }
        
        // --- 2. –†–£–õ–ï–¢–ö–ê ---
        let currentRotation = 0;
        
        function spinWheel() {
            const arrow = document.getElementById('spinner-arrow');
            const button = document.getElementById('spin-button');

            button.disabled = true;
            button.textContent = '–ö—Ä—É—Ç–∏—Ç—Å—è...';

            const stopAngle = Math.random() * 360;
            currentRotation += (5 * 360) + stopAngle; 

            arrow.style.transition = 'transform 4s cubic-bezier(0.25, 0.1, 0.25, 1)';
            arrow.style.transform = `translateX(-50%) rotate(${currentRotation}deg)`;

            setTimeout(() => {
                arrow.style.transition = 'none';
                
                button.textContent = '–ù–∞—á–∞—Ç—å —Ä–∞–∑–¥–∞—á—É —Ä–æ–ª–µ–π (–ò–≥—Ä–æ–∫ ‚Ññ1)';
                button.disabled = false;
                button.onclick = startRoleDistribution;
                
            }, 4000); 
        }

        // --- 3. –†–ê–ó–î–ê–ß–ê –†–û–õ–ï–ô (–°–ï–¢–ö–ê) –∏ updateCardAccessibility ---
        function startRoleDistribution() {
            currentPlayerIndex = 1; 
            
            const container = document.getElementById('role-cards-container');
            container.innerHTML = '';
            
            for (let i = 1; i <= playerCount; i++) {
                const card = document.createElement('button');
                card.textContent = `–ò–≥—Ä–æ–∫ ‚Ññ${i}`;
                card.id = `player-card-${i}`;
                
                card.className = `w-full py-6 rounded-lg font-bold transition duration-150`;
                
                container.appendChild(card);
            }

            showScreen('role-distribution-screen');
            updateCardAccessibility();
        }

        function updateCardAccessibility() {
            for (let i = 1; i <= playerCount; i++) {
                const card = document.getElementById(`player-card-${i}`);
                if (!card) continue;

                const isActive = (i === currentPlayerIndex);

                card.disabled = !isActive;

                card.classList.remove('bg-red-600', 'hover:bg-red-700', 'bg-gray-700', 'text-gray-500', 'cursor-not-allowed', 'bg-gray-500');

                if (i < currentPlayerIndex) {
                    card.classList.add('bg-gray-500', 'text-white', 'cursor-not-allowed');
                    card.textContent = `–ò–≥—Ä–æ–∫ ‚Ññ${i} (–°–º–æ—Ç—Ä–µ–ª)`;
                    card.onclick = null;
                } else if (isActive) {
                    card.classList.add('bg-red-600', 'hover:bg-red-700');
                    card.textContent = `–ò–≥—Ä–æ–∫ ‚Ññ${i}`;
                    document.getElementById('show-role-button').onclick = showRole;
                    document.getElementById('show-role-button').textContent = `–û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ä—Ç—É –ò–≥—Ä–æ–∫–∞ ‚Ññ${currentPlayerIndex}`;
                } else {
                    card.classList.add('bg-gray-700', 'text-gray-500', 'cursor-not-allowed');
                    card.textContent = `–ò–≥—Ä–æ–∫ ‚Ññ${i}`;
                    card.onclick = null;
                }
            }
            
            if (currentPlayerIndex <= playerCount) {
                document.getElementById('current-player-heading').textContent = `–°–º–æ—Ç—Ä–∏—Ç –ò–≥—Ä–æ–∫ ‚Ññ${currentPlayerIndex}`;
            }
        }

        // --- 4. –ü–†–û–°–ú–û–¢–† –†–û–õ–ò ---
        function showRole() {
            const role = roles[currentPlayerIndex];
            const imageContainer = document.getElementById('role-image-container');
            const roleContent = document.getElementById('role-content');
            
            imageContainer.innerHTML = ''; 

            if (role === '–®–ü–ò–û–ù') {
                document.getElementById('role-title').textContent = `–ò–≥—Ä–æ–∫ ${currentPlayerIndex}, –¢–í–û–Ø –†–û–õ–¨:`;
                roleContent.textContent = "–®–ü–ò–û–ù";
                roleContent.classList.remove('text-green-400');
                roleContent.classList.add('text-red-500');
            } else {
                document.getElementById('role-title').textContent = `–ò–≥—Ä–æ–∫ ${currentPlayerIndex}, –¢–í–û–Ø –ö–ê–†–¢–ê:`;
                roleContent.textContent = role.ru;
                roleContent.classList.remove('text-red-500');
                roleContent.classList.add('text-green-400');
                
                const img = document.createElement('img');
                img.src = getCardImage(role.slug);
                img.alt = role.ru;
                img.className = 'w-48 h-auto mx-auto rounded-lg shadow-2xl';
                img.onerror = function() {
                    this.onerror = null; 
                    this.src = getCardImage(null); 
                };

                imageContainer.appendChild(img);
            }
            
            document.getElementById('role-view-screen').classList.remove('hidden');
        }

        function hideRole() {
            document.getElementById('role-view-screen').classList.add('hidden');
            
            currentPlayerIndex++;

            if (currentPlayerIndex <= playerCount) {
                updateCardAccessibility();
            } else {
                // 5. –ò–ì–†–ê –ù–ê–ß–ê–õ–ê–°–¨
                showScreen('game-start-screen');
            }
        }
        
        // --- 6. –ü–û–ö–ê–ó–ê–¢–¨ –†–ï–ó–£–õ–¨–¢–ê–¢–´ ---
        function showResults() {
            showScreen('results-screen');
            
            document.getElementById('final-card').textContent = secretCardData.ru;

            const finalSpyTitle = document.getElementById('final-spy-title');
            const finalSpyContent = document.getElementById('final-spy');
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤
            if (spyIndex === 0) { // –í—Å–µ –®–ø–∏–æ–Ω—ã
                finalSpyTitle.textContent = `–®–ü–ò–û–ù–´:`;
                finalSpyContent.textContent = `–í–°–ï –ò–ì–†–û–ö–ò!`;
                finalSpyContent.classList.add('text-red-500');
                finalSpyContent.classList.remove('text-yellow-400', 'text-green-400');
            } else if (spyIndex === -1) { // –í—Å–µ –ú–∏—Ä–Ω—ã–µ
                finalSpyTitle.textContent = `–®–ü–ò–û–ù:`;
                finalSpyContent.textContent = `–ù–ï–¢ –®–ü–ò–û–ù–ê`;
                finalSpyContent.classList.add('text-green-400');
                finalSpyContent.classList.remove('text-yellow-400', 'text-red-500');
            } else { // –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º
                finalSpyTitle.textContent = `–®–ø–∏–æ–Ω:`;
                finalSpyContent.textContent = `–ò–≥—Ä–æ–∫ ‚Ññ${spyIndex}`;
                finalSpyContent.classList.add('text-yellow-400');
                finalSpyContent.classList.remove('text-red-500', 'text-green-400');
            }
        }
    </script>
</body>
</html>
